-- Skibidi Aim Pro by Colin
-- Instances
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TitleBar = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local ToggleAim = Instance.new("TextButton")
local ToggleESP = Instance.new("TextButton")
local RainbowToggle = Instance.new("TextButton")
local AimPartToggle = Instance.new("TextButton")
local CircleSlider = Instance.new("Frame")
local SliderTitle = Instance.new("TextLabel")
local SliderBackground = Instance.new("Frame")
local SliderFill = Instance.new("Frame")
local SliderButton = Instance.new("TextButton")
local SliderValue = Instance.new("TextLabel")
local AimCircle = Instance.new("Frame")
local CircleOutline = Instance.new("UIStroke")

--Properties
ScreenGui.Name = "SkibidiAimGui"
ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Aim Circle with outline - FOLLOWS CROSSHAIR
AimCircle.Name = "SkibidiCircle"
AimCircle.Parent = ScreenGui
AimCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
AimCircle.BackgroundTransparency = 1.0
AimCircle.BorderSizePixel = 0
AimCircle.Size = UDim2.new(0, 50, 0, 50)
AimCircle.AnchorPoint = Vector2.new(0.5, 0.5)
AimCircle.Visible = false

CircleOutline = Instance.new("UIStroke")
CircleOutline.Parent = AimCircle
CircleOutline.Color = Color3.fromRGB(255, 255, 255)
CircleOutline.Thickness = 2
CircleOutline.Transparency = 0.2

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(1, 0)
UICorner.Parent = AimCircle

-- Main Menu Frame - LARGER AND ROUNDED
MainFrame.Name = "SkibidiMenu"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
MainFrame.BackgroundTransparency = 0.1
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.05, 0, 0.05, 0)
MainFrame.Size = UDim2.new(0, 500, 0, 400)  -- Much larger
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

-- Rounded corners for main frame
local MainFrameCorner = Instance.new("UICorner")
MainFrameCorner.CornerRadius = UDim.new(0, 15)
MainFrameCorner.Parent = MainFrame

-- Add subtle shadow effect
local MainFrameShadow = Instance.new("UIStroke")
MainFrameShadow.Parent = MainFrame
MainFrameShadow.Color = Color3.fromRGB(20, 20, 20)
MainFrameShadow.Thickness = 3
MainFrameShadow.Transparency = 0.7

TitleBar.Parent = MainFrame
TitleBar.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
TitleBar.BorderSizePixel = 0
TitleBar.Size = UDim2.new(1, 0, 0, 40)

-- Rounded corners for title bar
local TitleBarCorner = Instance.new("UICorner")
TitleBarCorner.CornerRadius = UDim.new(0, 12)
TitleBarCorner.Parent = TitleBar

Title.Name = "Title"
Title.Parent = TitleBar
Title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1.0
Title.Size = UDim2.new(1, 0, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "SKIBIDI AIM PRO v2.0"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18.000
Title.TextStrokeTransparency = 0.8

-- AIM BOT Button - Rounded
ToggleAim.Name = "AimBotToggle"
ToggleAim.Parent = MainFrame
ToggleAim.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleAim.Position = UDim2.new(0.05, 0, 0.15, 0)
ToggleAim.Size = UDim2.new(0.4, 0, 0, 50)
ToggleAim.Font = Enum.Font.GothamBold
ToggleAim.Text = "AIM BOT: OFF"
ToggleAim.TextColor3 = Color3.fromRGB(255, 0, 0)
ToggleAim.TextSize = 16.000
ToggleAim.BorderSizePixel = 0

local AimCorner = Instance.new("UICorner")
AimCorner.CornerRadius = UDim.new(0, 12)
AimCorner.Parent = ToggleAim

-- ESP Button - Rounded
ToggleESP.Name = "ESPToggle"
ToggleESP.Parent = MainFrame
ToggleESP.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleESP.Position = UDim2.new(0.55, 0, 0.15, 0)
ToggleESP.Size = UDim2.new(0.4, 0, 0, 50)
ToggleESP.Font = Enum.Font.GothamBold
ToggleESP.Text = "ESP: OFF"
ToggleESP.TextColor3 = Color3.fromRGB(255, 0, 0)
ToggleESP.TextSize = 16.000
ToggleESP.BorderSizePixel = 0

local ESPCorner = Instance.new("UICorner")
ESPCorner.CornerRadius = UDim.new(0, 12)
ESPCorner.Parent = ToggleESP

-- RAINBOW Button - Rounded
RainbowToggle.Name = "RainbowToggle"
RainbowToggle.Parent = MainFrame
RainbowToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
RainbowToggle.Position = UDim2.new(0.05, 0, 0.3, 0)
RainbowToggle.Size = UDim2.new(0.4, 0, 0, 50)
RainbowToggle.Font = Enum.Font.GothamBold
RainbowToggle.Text = "RAINBOW: OFF"
RainbowToggle.TextColor3 = Color3.fromRGB(255, 0, 0)
RainbowToggle.TextSize = 16.000
RainbowToggle.BorderSizePixel = 0

local RainbowCorner = Instance.new("UICorner")
RainbowCorner.CornerRadius = UDim.new(0, 12)
RainbowCorner.Parent = RainbowToggle

-- Aim Part Toggle - Rounded
AimPartToggle.Name = "AimPartToggle"
AimPartToggle.Parent = MainFrame
AimPartToggle.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
AimPartToggle.Position = UDim2.new(0.55, 0, 0.3, 0)
AimPartToggle.Size = UDim2.new(0.4, 0, 0, 50)
AimPartToggle.Font = Enum.Font.GothamBold
AimPartToggle.Text = "AIM: HEAD"
AimPartToggle.TextColor3 = Color3.fromRGB(0, 255, 0)
AimPartToggle.TextSize = 16.000
AimPartToggle.BorderSizePixel = 0

local AimPartCorner = Instance.new("UICorner")
AimPartCorner.CornerRadius = UDim.new(0, 12)
AimPartCorner.Parent = AimPartToggle

-- Circle Slider - Rounded
CircleSlider.Parent = MainFrame
CircleSlider.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
CircleSlider.BorderSizePixel = 0
CircleSlider.Position = UDim2.new(0.05, 0, 0.5, 0)
CircleSlider.Size = UDim2.new(0.9, 0, 0, 80)

local SliderCornerMain = Instance.new("UICorner")
SliderCornerMain.CornerRadius = UDim.new(0, 10)
SliderCornerMain.Parent = CircleSlider

SliderTitle = Instance.new("TextLabel")
SliderTitle.Parent = CircleSlider
SliderTitle.BackgroundTransparency = 1.0
SliderTitle.Size = UDim2.new(1, 0, 0, 20)
SliderTitle.Font = Enum.Font.GothamBold
SliderTitle.Text = "CIRCLE SIZE"
SliderTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
SliderTitle.TextSize = 14.000

SliderBackground = Instance.new("Frame")
SliderBackground.Parent = CircleSlider
SliderBackground.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
SliderBackground.BorderSizePixel = 0
SliderBackground.Position = UDim2.new(0.05, 0, 0, 30)
SliderBackground.Size = UDim2.new(0.9, 0, 0, 15)

local SliderBgCorner = Instance.new("UICorner")
SliderBgCorner.CornerRadius = UDim.new(1, 0)
SliderBgCorner.Parent = SliderBackground

SliderFill = Instance.new("Frame")
SliderFill.Parent = SliderBackground
SliderFill.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
SliderFill.BorderSizePixel = 0
SliderFill.Size = UDim2.new(0.5, 0, 1, 0)

local SliderFillCorner = Instance.new("UICorner")
SliderFillCorner.CornerRadius = UDim.new(1, 0)
SliderFillCorner.Parent = SliderFill

SliderButton = Instance.new("TextButton")
SliderButton.Parent = SliderBackground
SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
SliderButton.BorderSizePixel = 0
SliderButton.Size = UDim2.new(0, 20, 0, 20)
SliderButton.Position = UDim2.new(0.5, -10, 0, -2.5)
SliderButton.Text = ""
local SliderButtonCorner = Instance.new("UICorner")
SliderButtonCorner.CornerRadius = UDim.new(1, 0)
SliderButtonCorner.Parent = SliderButton

SliderValue = Instance.new("TextLabel")
SliderValue.Parent = CircleSlider
SliderValue.BackgroundTransparency = 1.0
SliderValue.Position = UDim2.new(0, 0, 0, 55)
SliderValue.Size = UDim2.new(1, 0, 0, 20)
SliderValue.Font = Enum.Font.GothamBold
SliderValue.Text = "SIZE: 50"
SliderValue.TextColor3 = Color3.fromRGB(255, 255, 255)
SliderValue.TextSize = 14.000

-- Script Variables
local Aiming = false
local ESPing = false
local RainbowEnabled = false
local AimAtHead = true
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local ESPStore = {}
local CurrentCircleSize = 50
local MinCircleSize = 20
local MaxCircleSize = 300
local IsSliderDragging = false
local RainbowHue = 0

-- Get crosshair position (mouse position)
local function getCrosshairPosition()
    local mouse = LocalPlayer:GetMouse()
    return Vector2.new(mouse.X, mouse.Y)
end

-- Rainbow color function
local function getRainbowColor()
    RainbowHue = (RainbowHue + 0.01) % 1
    return Color3.fromHSV(RainbowHue, 1, 1)
end

local function updateRainbowColor()
    if RainbowEnabled and AimCircle.Visible then
        local rainbowColor = getRainbowColor()
        CircleOutline.Color = rainbowColor
    else
        CircleOutline.Color = Color3.fromRGB(255, 255, 255)
    end
end

-- Wall Check Function
local function isVisible(part)
    if not part then return false end
    local origin = Camera.CFrame.Position
    local target = part.Position
    local direction = (target - origin).Unit * (origin - target).Magnitude
    local ray = Ray.new(origin, direction)
    local hit, position = workspace:FindPartOnRayWithIgnoreList(ray, {LocalPlayer.Character, part.Parent})
    return hit == nil or hit:IsDescendantOf(part.Parent)
end

-- Check if enemy is in circle (RELATIVE TO CROSSHAIR)
local function isEnemyInCircle(enemyHead)
    if not enemyHead then return false end
    
    local screenPoint, visible = Camera:WorldToViewportPoint(enemyHead.Position)
    if not visible then return false end
    
    local crosshairPos = getCrosshairPosition()
    local enemyScreenPos = Vector2.new(screenPoint.X, screenPoint.Y)
    local distance = (enemyScreenPos - crosshairPos).Magnitude
    
    return distance <= CurrentCircleSize / 2
end

-- Get Closest Player in Circle Function
local function getClosestPlayerInCircle()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character:FindFirstChild("Head") then
            local character = player.Character
            local head = character.Head
            
            if isVisible(head) and isEnemyInCircle(head) then
                local distance = (LocalPlayer.Character.HumanoidRootPart.Position - head.Position).Magnitude
                if distance < shortestDistance then
                    shortestDistance = distance
                    closestPlayer = player
                end
            end
        end
    end
    return closestPlayer
end

-- Get target part (head or torso)
local function getTargetPart(character)
    if AimAtHead and character:FindFirstChild("Head") then
        return character.Head
    elseif character:FindFirstChild("HumanoidRootPart") then
        return character.HumanoidRootPart
    end
    return nil
end

-- Update Circle Size and Position
local function updateCircleSize(value)
    CurrentCircleSize = math.clamp(value, MinCircleSize, MaxCircleSize)
    AimCircle.Size = UDim2.new(0, CurrentCircleSize, 0, CurrentCircleSize)
    
    local fillPercent = (CurrentCircleSize - MinCircleSize) / (MaxCircleSize - MinCircleSize)
    SliderFill.Size = UDim2.new(fillPercent, 0, 1, 0)
    SliderButton.Position = UDim2.new(fillPercent, -10, 0, -2.5)
    SliderValue.Text = "SIZE: " .. CurrentCircleSize
end

-- Update circle position to follow crosshair
local function updateCirclePosition()
    if AimCircle.Visible then
        local crosshairPos = getCrosshairPosition()
        AimCircle.Position = UDim2.new(0, crosshairPos.X, 0, crosshairPos.Y)
    end
end

-- ESP Functions
local function createESP(player)
    if ESPStore[player] then return end
    
    local espContainer = Instance.new("Folder")
    espContainer.Name = player.Name .. "_ESP"
    espContainer.Parent = ScreenGui
    
    ESPStore[player] = {
        Container = espContainer,
        Highlight = nil,
        Billboard = nil,
        NameBillboard = nil,
        IsDead = false
    }
    
    local function updateESP()
        while ESPStore[player] and player do
            if player.Character and player.Character:FindFirstChild("Head") and player.Character:FindFirstChild("HumanoidRootPart") then
                if not ESPStore[player].Highlight then
                    local highlight = Instance.new("Highlight")
                    highlight.Parent = ESPStore[player].Container
                    highlight.Adornee = player.Character
                    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                    highlight.FillColor = Color3.fromRGB(255, 0, 0)
                    highlight.FillTransparency = 0.8
                    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
                    highlight.OutlineTransparency = 0
                    ESPStore[player].Highlight = highlight
                else
                    ESPStore[player].Highlight.Adornee = player.Character
                end
                
                if not ESPStore[player].Billboard then
                    local billboard = Instance.new("BillboardGui")
                    billboard.Parent = ESPStore[player].Container
                    billboard.Adornee = player.Character.Head
                    billboard.Size = UDim2.new(0, 50, 0, 6)
                    billboard.StudsOffset = Vector3.new(0, 1.8, 0)
                    billboard.AlwaysOnTop = true
                    
                    local healthBarBackground = Instance.new("Frame")
                    healthBarBackground.Parent = billboard
                    healthBarBackground.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                    healthBarBackground.BorderSizePixel = 0
                    healthBarBackground.Size = UDim2.new(1, 0, 1, 0)
                    
                    local healthBar = Instance.new("Frame")
                    healthBar.Parent = healthBarBackground
                    healthBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                    healthBar.BorderSizePixel = 0
                    healthBar.Size = UDim2.new(1, 0, 1, 0)
                    
                    ESPStore[player].Billboard = billboard
                    ESPStore[player].HealthBar = healthBar
                else
                    ESPStore[player].Billboard.Adornee = player.Character.Head
                end
                
                if not ESPStore[player].NameBillboard then
                    local nameBillboard = Instance.new("BillboardGui")
                    nameBillboard.Parent = ESPStore[player].Container
                    nameBillboard.Adornee = player.Character.Head
                    nameBillboard.Size = UDim2.new(0, 100, 0, 20)
                    nameBillboard.StudsOffset = Vector3.new(0, 2.5, 0)
                    nameBillboard.AlwaysOnTop = true
                    
                    local nameLabel = Instance.new("TextLabel")
                    nameLabel.Parent = nameBillboard
                    nameLabel.BackgroundTransparency = 1.0
                    nameLabel.Text = player.Name
                    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                    nameLabel.TextSize = 12.000
                    nameLabel.Size = UDim2.new(1, 0, 1, 0)
                    nameLabel.Font = Enum.Font.SciFi
                    
                    ESPStore[player].NameBillboard = nameBillboard
                    ESPStore[player].NameLabel = nameLabel
                else
                    ESPStore[player].NameBillboard.Adornee = player.Character.Head
                end
                
                local humanoid = player.Character:FindFirstChild("Humanoid")
                if humanoid then
                    local healthPercent = humanoid.Health / humanoid.MaxHealth
                    ESPStore[player].HealthBar.Size = UDim2.new(math.clamp(healthPercent, 0, 1), 0, 1, 0)
                    
                    if humanoid.Health <= 0 then
                        ESPStore[player].IsDead = true
                        ESPStore[player].Highlight.FillColor = Color3.fromRGB(100, 100, 100)
                        ESPStore[player].HealthBar.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                        ESPStore[player].NameLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
                    else
                        ESPStore[player].IsDead = false
                        ESPStore[player].Highlight.FillColor = Color3.fromRGB(255, 0, 0)
                        ESPStore[player].HealthBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                        ESPStore[player].NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                    end
                end
            else
                if ESPStore[player].Highlight then
                    ESPStore[player].Highlight.Adornee = nil
                end
                if ESPStore[player].Billboard then
                    ESPStore[player].Billboard.Adornee = nil
                end
                if ESPStore[player].NameBillboard then
                    ESPStore[player].NameBillboard.Adornee = nil
                end
                ESPStore[player].IsDead = true
            end
            wait(0.1)
        end
    end
    
    coroutine.wrap(updateESP)()
end

local function removeESP(player)
    if ESPStore[player] then
        if ESPStore[player].Container then
            ESPStore[player].Container:Destroy()
        end
        ESPStore[player] = nil
    end
end

local function toggleAllESP(state)
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            if state then
                createESP(player)
            else
                removeESP(player)
            end
        end
    end
end

-- Toggle Functions
ToggleAim.MouseButton1Click:Connect(function()
    Aiming = not Aiming
    if Aiming then
        ToggleAim.Text = "AIM BOT: ON"
        ToggleAim.TextColor3 = Color3.fromRGB(0, 255, 0)
        AimCircle.Visible = true
    else
        ToggleAim.Text = "AIM BOT: OFF"
        ToggleAim.TextColor3 = Color3.fromRGB(255, 0, 0)
        AimCircle.Visible = false
    end
end)

ToggleESP.MouseButton1Click:Connect(function()
    ESPing = not ESPing
    if ESPing then
        ToggleESP.Text = "ESP: ON"
        ToggleESP.TextColor3 = Color3.fromRGB(0, 255, 0)
        toggleAllESP(true)
    else
        ToggleESP.Text = "ESP: OFF"
        ToggleESP.TextColor3 = Color3.fromRGB(255, 0, 0)
        toggleAllESP(false)
    end
end)

RainbowToggle.MouseButton1Click:Connect(function()
    RainbowEnabled = not RainbowEnabled
    if RainbowEnabled then
        RainbowToggle.Text = "RAINBOW: ON"
        RainbowToggle.TextColor3 = Color3.fromRGB(0, 255, 0)
    else
        RainbowToggle.Text = "RAINBOW: OFF"
        RainbowToggle.TextColor3 = Color3.fromRGB(255, 0, 0)
        CircleOutline.Color = Color3.fromRGB(255, 255, 255)
    end
end)

AimPartToggle.MouseButton1Click:Connect(function()
    AimAtHead = not AimAtHead
    if AimAtHead then
        AimPartToggle.Text = "AIM: HEAD"
        AimPartToggle.TextColor3 = Color3.fromRGB(0, 255, 0)
    else
        AimPartToggle.Text = "AIM: BODY"
        AimPartToggle.TextColor3 = Color3.fromRGB(255, 165, 0)
    end
end)

-- Slider functionality
SliderButton.MouseButton1Down:Connect(function()
    IsSliderDragging = true
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        IsSliderDragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if IsSliderDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local mousePos = UserInputService:GetMouseLocation()
        local sliderAbsolutePos = SliderBackground.AbsolutePosition
        local sliderAbsoluteSize = SliderBackground.AbsoluteSize
        
        local relativeX = math.clamp((mousePos.X - sliderAbsolutePos.X) / sliderAbsoluteSize.X, 0, 1)
        local newSize = math.floor(MinCircleSize + relativeX * (MaxCircleSize - MinCircleSize))
        updateCircleSize(newSize)
    end
end)

-- M key to toggle menu
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.M then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- Main update loop
RunService.RenderStepped:Connect(function()
    updateRainbowColor()
    
    -- Update circle position to follow crosshair
    updateCirclePosition()
    
    if Aiming and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local target = getClosestPlayerInCircle()
        if target and target.Character then
            local humanoid = target.Character:FindFirstChild("Humanoid")
            local targetPart = getTargetPart(target.Character)
            
            if humanoid and humanoid.Health > 0 and targetPart then
                Camera.CFrame = CFrame.new(Camera.CFrame.Position, targetPart.Position)
            end
        end
    end
end)

-- Initial cleanup
for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        removeESP(player)
    end
end

-- Handle players
Players.PlayerAdded:Connect(function(player)
    if ESPing then
        createESP(player)
    end
end)

Players.PlayerRemoving:Connect(function(player)
    removeESP(player)
end)

-- Auto-create ESP for existing players if enabled
if ESPing then
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            createESP(player)
        end
    end
end

-- Initialize circle size
updateCircleSize(50)

print("Skibidi Aim Pro loaded successfully! Press M to toggle menu.")
